<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>账单</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Helvetica Neue",sans-serif}
:root{
--bg:#F2F2F7;--card:#fff;--primary:#007AFF;--success:#34C759;--danger:#FF3B30;
--text:#000;--sub:#8E8E93
}
@media (prefers-color-scheme: dark){
:root{--bg:#000;--card:#1C1C1E;--text:#fff}
}
body{
background:var(--bg);color:var(--text);
padding:20px;padding-top:calc(20px + env(safe-area-inset-top));
padding-bottom:calc(20px + env(safe-area-inset-bottom))
}
.container{max-width:520px;margin:0 auto;display:flex;flex-direction:column;gap:28px}

/* ===== overview ===== */
.overview{
background:var(--card);border-radius:22px;padding:22px;
box-shadow:0 8px 30px rgba(0,0,0,.08)
}
.overview-header{font-size:18px;font-weight:600;margin-bottom:18px}
.overview-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;text-align:center}
.overview-value{font-size:30px;font-weight:700}
.overview-label{font-size:13px;color:var(--sub);margin-top:4px}
.income{color:var(--success)}.expense{color:var(--danger)}.balance{color:var(--primary)}

/* ===== card ===== */
.card{
background:var(--card);border-radius:20px;padding:20px;
box-shadow:0 6px 24px rgba(0,0,0,.06)
}
.card-title{font-size:20px;font-weight:700;margin-bottom:16px}

/* ===== bills ===== */
.bill{display:flex;justify-content:space-between;padding:14px 0}
.bill+.bill{border-top:1px solid rgba(0,0,0,.06)}
.bill-left{display:flex;flex-direction:column;gap:4px}
.bill-category{font-size:16px;font-weight:600}
.bill-date{font-size:13px;color:var(--sub)}
.bill-amount{font-size:18px;font-weight:700}
.bill.income .bill-amount{color:var(--success)}
.bill.expense .bill-amount{color:var(--danger)}

/* ===== fab ===== */
.fab{
position:fixed;right:20px;bottom:calc(24px + env(safe-area-inset-bottom));
width:58px;height:58px;border-radius:29px;
background:var(--primary);color:#fff;font-size:32px;border:none;
box-shadow:0 10px 30px rgba(0,0,0,.25)
}
.fab:active{transform:scale(.94)}

/* ===== modal ===== */
.modal{
position:fixed;inset:0;background:rgba(0,0,0,.4);
display:none;align-items:flex-end;justify-content:center
}
.modal.active{display:flex}
.sheet{
background:var(--card);width:100%;border-radius:20px 20px 0 0;
padding:20px;animation:up .3s ease
}
@keyframes up{from{transform:translateY(100%)}to{transform:none}}

input,select{
width:100%;padding:14px;border-radius:12px;
border:1px solid rgba(0,0,0,.15);font-size:16px
}
button.primary{
background:var(--primary);color:#fff;border:none;
padding:14px;border-radius:14px;font-size:16px;margin-top:12px;width:100%
}
</style>
</head>

<body>
<div class="container">

<div class="overview">
<div class="overview-header" id="month"></div>
<div class="overview-grid">
<div><div class="overview-value income" id="inc">0</div><div class="overview-label">收入</div></div>
<div><div class="overview-value expense" id="exp">0</div><div class="overview-label">支出</div></div>
<div><div class="overview-value balance" id="bal">0</div><div class="overview-label">结余</div></div>
</div>
</div>

<div class="card">
<div class="card-title">近期账单</div>
<div id="list"></div>
</div>

</div>

<button class="fab" onclick="openAdd()">+</button>

<div class="modal" id="modal">
<div class="sheet">
<select id="cat"></select>
<input id="amt" type="number" placeholder="金额">
<select id="type">
<option value="expense">支出</option>
<option value="income">收入</option>
</select>
<button class="primary" onclick="save()">保存</button>
</div>
</div>

<script>
let bills=JSON.parse(localStorage.getItem("bills")||"[]");
let cats=["餐饮","购物","交通","工资","其他"];
const now=new Date();

function render(){
let inc=0,exp=0;
document.getElementById("list").innerHTML="";
bills.filter(b=>{
const d=new Date(b.date);
return d.getMonth()===now.getMonth()&&d.getFullYear()===now.getFullYear()
}).forEach(b=>{
if(b.type==="income")inc+=b.amount;else exp+=b.amount;
const el=document.createElement("div");
el.className="bill "+b.type;
el.innerHTML=`
<div class="bill-left">
<div class="bill-category">${b.cat}</div>
<div class="bill-date">${b.date}</div>
</div>
<div class="bill-amount">${b.type==="income"?"+":"-"}¥${b.amount}</div>`;
document.getElementById("list").appendChild(el);
});
document.getElementById("inc").innerText="¥"+inc;
document.getElementById("exp").innerText="¥"+exp;
document.getElementById("bal").innerText="¥"+(inc-exp);
document.getElementById("month").innerText=`${now.getFullYear()}年${now.getMonth()+1}月`;
}

function openAdd(){
document.getElementById("modal").classList.add("active");
document.getElementById("cat").innerHTML=cats.map(c=>`<option>${c}</option>`).join("");
}
function save(){
bills.push({
cat:cat.value,
amount:+amt.value,
type:type.value,
date:new Date().toLocaleDateString()
});
localStorage.setItem("bills",JSON.stringify(bills));
document.getElementById("modal").classList.remove("active");
render();
}

render();
</script>
</body>
</html>
