<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="default"/>
    <title>å¦ä¸€ä¸ªæˆ‘ - è®°è´¦APP</title>
    <style>
        /* å…¨å±€é‡ç½® */
        * { 
            margin: 0; padding: 0; box-sizing: border-box; 
            -webkit-user-select: none; user-select: none;
        }
        body { 
            background: #F2F2F7; 
            padding-bottom: 90px; 
            font-size: 16px; 
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
        }

        /* å¯†ç é” */
        .lock-screen {
            position: fixed; top:0; left:0; right:0; bottom:0;
            background: #F2F2F7; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            padding: 0 20px;
        }
        .lock-title {
            font-size: 20px; color: #1C1C1E; margin-bottom: 30px;
        }
        .password-inputs { 
            display: flex; gap: 15px; margin-bottom: 20px;
            width: 100%; max-width: 300px;
        }
        .password-input {
            width: 20%; height: 50px; 
            border: 2px solid #E5E5EA; border-radius: 12px;
            text-align: center; font-size: 28px;
            background: #fff;
            -webkit-appearance: none; appearance: none;
        }
        .password-input:focus { border-color: #1C1C1E; outline: none; }

        /* ä¸»é¡µé¢ */
        .main-title {
            padding: 20px 16px;
            font-size: 24px; font-weight: 600;
            color: #1C1C1E;
        }

        /* æ”¶æ”¯ç»Ÿè®¡å¡ç‰‡ï¼ˆæ–°å¢é¢„ç®—/ä½™é¢åŒºåŸŸï¼‰ */
        .stats-card {
            background: #fff;
            border-radius: 16px;
            margin: 0 16px 16px;
            padding: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .stats-row {
            display: flex; justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #F2F2F7;
        }
        .stats-row:last-child { border-bottom: none; }
        .stats-label {
            font-size: 16px; color: #8E8E93;
        }
        .stats-value {
            font-size: 18px; font-weight: 600;
        }
        .stats-value.expense { color: #FF3B30; }
        .stats-value.income { color: #34C759; }
        .stats-value.balance { color: #007AFF; }

        /* é¢„ç®—åŒºåŸŸæ ·å¼ï¼ˆæ ¸å¿ƒï¼šä»…å±•ç¤ºæ‰‹åŠ¨æ·»åŠ çš„é¢„ç®—ï¼‰ */
        .budget-section {
            margin-top: 15px;
        }
        .budget-header {
            display: flex; justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .budget-title {
            font-size: 16px; font-weight: 600;
            color: #1C1C1E;
        }
        .set-budget-btn {
            font-size: 14px;
            color: #007AFF;
            background: transparent;
            border: none;
            padding: 4px 8px;
            border-radius: 8px;
            cursor: pointer;
        }
        .budget-list {
            max-height: 200px;
            overflow-y: auto;
        }
        .budget-item {
            display: flex; justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #F2F2F7;
        }
        .budget-item:last-child { border-bottom: none; }
        .budget-cate {
            display: flex; align-items: center;
            gap: 8px;
        }
        .budget-cate-icon {
            font-size: 16px;
        }
        .budget-cate-name {
            font-size: 14px;
        }
        .budget-usage {
            text-align: right;
        }
        .budget-used {
            font-size: 14px;
            color: #1C1C1E;
        }
        .budget-remain {
            font-size: 12px;
            color: #8E8E93;
        }
        .budget-over {
            color: #FF3B30 !important;
        }
        .budget-empty {
            text-align: center;
            padding: 10px;
            color: #8E8E93;
            font-size: 14px;
        }

        /* æœ€è¿‘è´¦å•åŒºåŸŸ */
        .bills-section {
            padding: 0 16px;
        }
        .bills-title {
            font-size: 16px; font-weight: 600;
            margin-bottom: 10px;
        }
        .bills-empty {
            text-align: center;
            padding: 30px 0;
            color: #8E8E93;
            font-size: 14px;
        }

        /* è´¦å•æ»‘åŠ¨åˆ é™¤å®¹å™¨ */
        .bill-swipe-container {
            position: relative;
            width: 100%;
            margin-bottom: 10px;
            overflow: hidden;
            border-radius: 12px;
        }
        .bill-item {
            background: #fff;
            padding: 12px 16px;
            display: flex; justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.03);
            position: relative;
            left: 0;
            transition: left 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 2;
        }
        .bill-delete-btn {
            position: absolute;
            top: 50%; right: 10px;
            transform: translateY(-50%);
            width: 44px; height: 44px;
            background: #FF3B30;
            color: #fff;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            outline: none;
            cursor: pointer;
        }
        .bill-delete-btn::before,
        .bill-delete-btn::after {
            content: '';
            position: absolute;
            background: #fff;
            border-radius: 1px;
        }
        .bill-delete-btn::before {
            width: 14px;
            height: 10px;
            border: 2px solid #fff;
            border-bottom: none;
            border-radius: 2px 2px 0 0;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
        }
        .bill-delete-btn::after {
            width: 18px;
            height: 2px;
            bottom: 12px;
            left: 50%;
            transform: translateX(-50%);
        }

        .bill-left {
            display: flex; align-items: center;
        }
        .bill-icon {
            width: 36px; height: 36px;
            background: #F2F2F7; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            margin-right: 10px;
            font-size: 16px;
        }
        .bill-info {
            display: flex; flex-direction: column;
        }
        .bill-category {
            font-size: 14px; font-weight: 500;
        }
        .bill-date {
            font-size: 12px; color: #8E8E93;
        }
        .bill-amount {
            font-size: 15px; font-weight: 500;
        }
        .bill-amount.expense { color: #FF3B30; }
        .bill-amount.income { color: #34C759; }

        /* åº•éƒ¨åŠŸèƒ½æŒ‰é’®ç»„ */
        .btn-group {
            position: fixed; bottom: 20px; right: 20px;
            display: flex; flex-direction: column; gap: 12px;
        }
        .add-btn {
            width: 60px; height: 60px; border-radius: 50%;
            background: #1C1C1E; color: #fff; font-size: 36px;
            border: none; cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex; align-items: center; justify-content: center;
        }
        .calendar-btn {
            width: 60px; height: 60px; border-radius: 50%;
            background: #F8F8FA;
            color: #1C1C1E; font-size: 24px; font-weight: 600;
            border: none; cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex; align-items: center; justify-content: center;
            border: 1px solid rgba(0,0,0,0.05);
        }
        .selected-date-tip {
            background: #fff;
            border-radius: 16px;
            margin: 0 16px 16px;
            padding: 12px 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            font-size: 15px;
            color: #1C1C1E;
            text-align: center;
        }

        /* è®°è´¦å¼¹çª— */
        .modal {
            position: fixed; top:0; left:0; right:0; bottom:0;
            background: rgba(0,0,0,0.5); display: none;
            z-index: 100;
        }
        .modal.show { display: block; }
        .modal-content {
            position: fixed; bottom:0; left:0; right:0;
            background: #fff; border-top-left-radius: 24px;
            border-top-right-radius: 24px;
            padding: 24px 16px;
            max-height: 90vh; overflow-y: auto;
        }
        .modal-title {
            font-size: 20px; font-weight: 600;
            margin-bottom: 20px; text-align: center;
        }
        .amount-input {
            width: 100%; font-size: 32px; text-align: center;
            margin: 10px 0 20px; padding: 10px 0;
            border: none; border-bottom: 1px solid #E5E5EA;
            -webkit-appearance: none; appearance: none;
            outline: none;
        }
        .amount-input:focus { border-bottom-color: #1C1C1E; }
        .type-toggle {
            display: flex; gap: 10px; margin: 10px 0 20px;
        }
        .type-btn {
            flex: 1; padding: 12px 0;
            border-radius: 20px; border: 2px solid #E5E5EA;
            background: transparent; font-size: 16px;
            -webkit-tap-highlight-color: transparent;
            cursor: pointer;
        }
        .type-btn.active {
            border-color: #1C1C1E; background: #1C1C1E; color: #fff;
        }
        .category-label {
            font-size: 14px; color: #8E8E93;
            margin-bottom: 10px;
        }
        .longpress-tip {
            font-size: 12px; color: #8E8E93;
            text-align: center; margin-bottom: 10px;
        }
        .category-grid {
            display: grid; 
            grid-template-columns: repeat(4, 1fr);
            gap: 12px; margin: 10px 0 20px;
        }
        .category-item {
            display: flex; flex-direction: column;
            align-items: center;
            -webkit-tap-highlight-color: transparent;
            cursor: pointer;
        }
        .category-icon {
            width: 50px; height: 50px; 
            background: #F2F2F7; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 20px; margin-bottom: 6px;
        }
        .category-item.active .category-icon {
            background: #1C1C1E; color: #fff;
        }
        .category-name {
            font-size: 12px; color: #8E8E93;
            text-align: center;
        }
        .category-item.active .category-name {
            color: #1C1C1E; font-weight: 500;
        }
        .add-cate-btn {
            width: 100%; padding: 12px;
            border: 1px dashed #E5E5EA; border-radius: 12px;
            background: #F9F9F9; font-size: 16px;
            color: #8E8E93; margin: 10px 0 20px;
            -webkit-tap-highlight-color: transparent;
            cursor: pointer;
        }
        .modal-btn {
            width: 100%; padding: 14px 0;
            border-radius: 12px; border: none;
            font-size: 16px; font-weight: 500;
            margin-bottom: 10px;
            -webkit-tap-highlight-color: transparent;
            cursor: pointer;
        }
        .save-btn { background: #1C1C1E; color: #fff; }
        .close-btn { background: #F2F2F7; color: #1C1C1E; }

        /* æ–°å¢åˆ†ç±»å¼¹çª— */
        .add-cate-modal {
            position: fixed; top:0; left:0; right:0; bottom:0;
            background: rgba(0,0,0,0.5); display: none;
            align-items: center; justify-content: center;
            z-index: 200;
            padding: 0 20px;
        }
        .add-cate-modal.show { display: flex; }
        .add-cate-content {
            background: #fff; padding: 24px;
            border-radius: 20px; width: 100%; max-width: 300px;
        }
        .add-cate-title {
            font-size: 18px; font-weight: 600;
            margin-bottom: 15px; text-align: center;
        }
        .add-cate-input {
            width: 100%; padding: 12px;
            border: 1px solid #E5E5EA; border-radius: 12px;
            font-size: 16px; margin-bottom: 15px;
            -webkit-appearance: none; appearance: none;
            outline: none;
        }
        .add-cate-input:focus { border-color: #1C1C1E; }
        .add-cate-btn-group {
            display: flex; gap: 10px;
        }
        .add-cate-submit {
            flex: 1; padding: 12px;
            border-radius: 12px; border: none;
            background: #1C1C1E; color: #fff;
            font-size: 16px;
            cursor: pointer;
        }
        .add-cate-cancel {
            flex: 1; padding: 12px;
            border-radius: 12px; border: 1px solid #E5E5EA;
            background: transparent; font-size: 16px;
            cursor: pointer;
        }

        /* é¢„ç®—è®¾ç½®å¼¹çª—ï¼ˆæ ¸å¿ƒï¼šæ‰‹åŠ¨æ·»åŠ åˆ†ç±»+é‡‘é¢ï¼‰ */
        .budget-modal {
            position: fixed; top:0; left:0; right:0; bottom:0;
            background: rgba(0,0,0,0.5); display: none;
            align-items: center; justify-content: center;
            z-index: 200;
            padding: 0 20px;
        }
        .budget-modal.show { display: flex; }
        .budget-modal-content {
            background: #fff; padding: 24px;
            border-radius: 20px; width: 100%; max-width: 350px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .budget-modal-title {
            font-size: 18px; font-weight: 600;
            margin-bottom: 20px; text-align: center;
        }
        .budget-set-item {
            display: flex; justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #F2F2F7;
        }
        .budget-set-cate {
            display: flex; align-items: center;
            gap: 8px;
        }
        .budget-set-icon {
            font-size: 16px;
        }
        .budget-set-name {
            font-size: 14px;
        }
        .budget-set-input {
            width: 80px;
            padding: 6px 8px;
            border: 1px solid #E5E5EA;
            border-radius: 8px;
            font-size: 14px;
            text-align: right;
            outline: none;
        }
        .budget-modal-btn-group {
            display: flex; gap: 10px;
            margin-top: 20px;
        }
        .budget-save-btn {
            flex: 1; padding: 12px;
            border-radius: 12px; border: none;
            background: #1C1C1E; color: #fff;
            font-size: 16px;
            cursor: pointer;
        }
        .budget-cancel-btn {
            flex: 1; padding: 12px;
            border-radius: 12px; border: 1px solid #E5E5EA;
            background: transparent; font-size: 16px;
            cursor: pointer;
        }

        /* è‡ªå®šä¹‰æç¤ºæ¡† */
        .custom-alert {
            position: fixed; top:0; left:0; right:0; bottom:0;
            background: rgba(0,0,0,0.5);
            display: flex; align-items: center; justify-content: center;
            z-index: 300;
            display: none;
        }
        .alert-content {
            background: #000; color: #fff;
            padding: 24px; border-radius: 12px;
            width: 80%; max-width: 300px;
            text-align: center;
        }
        .alert-text {
            font-size: 16px; margin-bottom: 15px;
        }
        .alert-close {
            background: transparent;
            border: 1px solid #fff; color: #fff;
            padding: 8px 20px; border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
        }

        /* æ—¥å†å¼¹çª— */
        .calendar-modal {
            position: fixed; top:0; left:0; right:0; bottom:0;
            background: rgba(0,0,0,0.5); display: none;
            z-index: 150;
        }
        .calendar-modal.show { display: flex; align-items: center; justify-content: center; }
        .calendar-modal-content {
            background: #fff;
            border-radius: 24px;
            width: 90%; max-width: 400px;
            padding: 20px;
            max-height: 80vh;
            overflow: hidden;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid #F2F2F7;
        }
        .calendar-nav {
            display: flex; gap: 8px;
        }
        .calendar-nav-btn {
            width: 36px; height: 36px;
            border-radius: 50%;
            border: none;
            background: transparent;
            color: #007AFF;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: rgba(0, 122, 255, 0.1);
            cursor: pointer;
        }
        .calendar-date-select {
            display: flex; gap: 8px;
            align-items: center;
        }
        .calendar-select {
            padding: 4px 8px;
            border: 1px solid #E5E5EA;
            border-radius: 8px;
            background: #F9F9F9;
            color: #1C1C1E;
            font-size: 16px;
            -webkit-appearance: none;
            appearance: none;
            outline: none;
        }
        .calendar-month-text {
            font-size: 17px;
            font-weight: 500;
            color: #1C1C1E;
            margin: 0 8px;
        }
        .calendar-close-btn {
            width: 36px; height: 36px;
            border-radius: 50%;
            border: none;
            background: #F2F2F7;
            color: #1C1C1E;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .calendar-week {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            margin-bottom: 8px;
        }
        .calendar-week-item {
            font-size: 12px;
            padding: 4px 0;
            color: #8E8E93;
        }
        .calendar-week-item:first-child {
            color: #FF3B30;
        }
        .calendar-wrap {
            overflow: hidden;
            touch-action: none;
        }
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            transition: transform 0.3s ease;
        }
        .calendar-day {
            aspect-ratio: 1/1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 14px;
            color: #1C1C1E;
            background: transparent;
            -webkit-tap-highlight-color: rgba(0, 122, 255, 0.1);
            cursor: pointer;
            touch-action: manipulation;
        }
        .calendar-day.empty {
            color: #C7C7CC;
            cursor: default;
            touch-action: none;
        }
        .calendar-day.today {
            border: 1px solid #8E8E93;
            font-weight: 500;
        }
        .calendar-day.has-bill {
            position: relative;
        }
        .calendar-day.has-bill::after {
            content: '';
            position: absolute;
            bottom: 2px;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #FF3B30;
        }
        .calendar-day.active {
            background: #007AFF;
            color: #fff;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- å¯†ç é”é¡µé¢ -->
    <div class="lock-screen" id="lockScreen">
        <div class="lock-title">è¯·è¾“å…¥4ä½æ•°å­—å¯†ç </div>
        <div class="password-inputs">
            <input type="password" class="password-input" maxlength="1" oninput="nextInput(this)">
            <input type="password" class="password-input" maxlength="1" oninput="nextInput(this)">
            <input type="password" class="password-input" maxlength="1" oninput="nextInput(this)">
            <input type="password" class="password-input" maxlength="1" oninput="checkPassword()">
        </div>
    </div>

    <!-- è‡ªå®šä¹‰æç¤ºæ¡† -->
    <div class="custom-alert" id="customAlert">
        <div class="alert-content">
            <div class="alert-text" id="alertText"></div>
            <button class="alert-close" onclick="closeAlert()">å…³é—­</button>
        </div>
    </div>

    <!-- ä¸»é¡µé¢ -->
    <div id="mainPage" style="display: none;">
        <div class="main-title">å¦ä¸€ä¸ªæˆ‘</div>

        <!-- æœ¬æœˆæ”¶æ”¯ç»Ÿè®¡å¡ç‰‡ï¼ˆå«ä½™é¢+æ‰‹åŠ¨é¢„ç®—ï¼‰ -->
        <div class="stats-card">
            <div class="stats-row">
                <div class="stats-label">æœ¬æœˆæ”¯å‡º</div>
                <div class="stats-value expense" id="monthExpense">Â¥0.00</div>
            </div>
            <div class="stats-row">
                <div class="stats-label">æœ¬æœˆæ”¶å…¥</div>
                <div class="stats-value income" id="monthIncome">Â¥0.00</div>
            </div>
            <div class="stats-row">
                <div class="stats-label">è´¦æˆ·ä½™é¢</div>
                <div class="stats-value balance" id="accountBalance">Â¥0.00</div>
            </div>
            
            <!-- é¢„ç®—åŒºåŸŸï¼ˆæ ¸å¿ƒï¼šä»…å±•ç¤ºæ‰‹åŠ¨æ·»åŠ çš„é¢„ç®—ï¼‰ -->
            <div class="budget-section">
                <div class="budget-header">
                    <div class="budget-title">æœ¬æœˆåˆ†ç±»é¢„ç®—</div>
                    <button class="set-budget-btn" onclick="openBudgetModal()">è®¾ç½®é¢„ç®—</button>
                </div>
                <div class="budget-list" id="budgetList">
                    <!-- æ— æ‰‹åŠ¨é¢„ç®—æ—¶æ˜¾ç¤ºç©ºæç¤ºï¼Œæœ‰åˆ™åŠ¨æ€æ¸²æŸ“ -->
                    <div class="budget-empty">æš‚æ— æ‰‹åŠ¨è®¾ç½®çš„é¢„ç®—ï¼Œç‚¹å‡»"è®¾ç½®é¢„ç®—"æ·»åŠ </div>
                </div>
            </div>
        </div>

        <!-- é€‰ä¸­æ—¥æœŸæç¤º -->
        <div class="selected-date-tip" id="selectedDateTip">å½“å‰é€‰ä¸­ï¼š2025å¹´12æœˆ22æ—¥ï¼ˆä»Šæ—¥ï¼‰</div>

        <!-- æœ€è¿‘è´¦å•åŒºåŸŸ -->
        <div class="bills-section">
            <div class="bills-title">å½“æ—¥è´¦å•</div>
            <div id="recentBillsList">
                <div class="bills-empty">æš‚æ— è´¦å•ï¼Œç‚¹å‡»+å¼€å§‹è®°å½•</div>
            </div>
        </div>

        <!-- åº•éƒ¨åŠŸèƒ½æŒ‰é’®ç»„ -->
        <div class="btn-group">
            <button class="add-btn" onclick="openBillModal()">+</button>
            <button class="calendar-btn" onclick="openCalendarModal()">æ—¥</button>
        </div>

        <!-- è®°è´¦å¼¹çª— -->
        <div class="modal" id="billModal">
            <div class="modal-content">
                <div class="modal-title">è®°ä¸€ç¬”</div>
                <input type="number" class="amount-input" id="billAmount" placeholder="0.00" min="0.01" step="0.01">
                <div class="type-toggle">
                    <button class="type-btn active" onclick="setType('expense')">æ”¯å‡º</button>
                    <button class="type-btn" onclick="setType('income')">æ”¶å…¥</button>
                </div>
                
                <div class="category-label">åˆ†ç±»ï¼ˆé•¿æŒ‰åˆ é™¤ï¼‰</div>
                <div class="longpress-tip">é•¿æŒ‰åˆ†ç±»å¯åˆ é™¤</div>
                <div class="category-grid" id="categoryGrid"></div>
                
                <button class="add-cate-btn" onclick="openAddCateModal()">+ æ–°å¢åˆ†ç±»</button>
                
                <button class="modal-btn save-btn" onclick="saveBill()">ä¿å­˜</button>
                <button class="modal-btn close-btn" onclick="closeBillModal()">å…³é—­</button>
            </div>
        </div>

        <!-- æ–°å¢åˆ†ç±»å¼¹çª— -->
        <div class="add-cate-modal" id="addCateModal">
            <div class="add-cate-content">
                <div class="add-cate-title">æ–°å¢åˆ†ç±»</div>
                <input type="text" class="add-cate-input" id="newCateInput" placeholder="æ¯”å¦‚ï¼šå¥¶èŒ¶ã€è¯è´¹">
                <div class="add-cate-btn-group">
                    <button class="add-cate-submit" onclick="saveNewCate()">ç¡®è®¤</button>
                    <button class="add-cate-cancel" onclick="closeAddCateModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>

        <!-- é¢„ç®—è®¾ç½®å¼¹çª—ï¼ˆæ‰‹åŠ¨æ·»åŠ åˆ†ç±»+é‡‘é¢ï¼‰ -->
        <div class="budget-modal" id="budgetModal">
            <div class="budget-modal-content">
                <div class="budget-modal-title">è®¾ç½®æœ¬æœˆåˆ†ç±»é¢„ç®—</div>
                <div id="budgetSetList"></div>
                <div class="budget-modal-btn-group">
                    <button class="budget-save-btn" onclick="saveAllBudgets()">ä¿å­˜é¢„ç®—</button>
                    <button class="budget-cancel-btn" onclick="closeBudgetModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>

        <!-- æ—¥å†å¼¹çª— -->
        <div class="calendar-modal" id="calendarModal">
            <div class="calendar-modal-content">
                <div class="calendar-header">
                    <div class="calendar-nav">
                        <button class="calendar-nav-btn" onclick="changeMonth(-1)">â—€</button>
                        <div class="calendar-date-select">
                            <select class="calendar-select" id="yearSelect" onchange="jumpToSelectedDate()">
                                <option value="2023">2023</option>
                                <option value="2024">2024</option>
                                <option value="2025" selected>2025</option>
                                <option value="2026">2026</option>
                            </select>
                            <select class="calendar-select" id="monthSelect" onchange="jumpToSelectedDate()">
                                <option value="1">1æœˆ</option>
                                <option value="2">2æœˆ</option>
                                <option value="3">3æœˆ</option>
                                <option value="4">4æœˆ</option>
                                <option value="5">5æœˆ</option>
                                <option value="6">6æœˆ</option>
                                <option value="7">7æœˆ</option>
                                <option value="8">8æœˆ</option>
                                <option value="9">9æœˆ</option>
                                <option value="10">10æœˆ</option>
                                <option value="11">11æœˆ</option>
                                <option value="12" selected>12æœˆ</option>
                            </select>
                        </div>
                        <button class="calendar-nav-btn" onclick="changeMonth(1)">â–¶</button>
                    </div>
                    <button class="calendar-close-btn" onclick="closeCalendarModal()">Ã—</button>
                </div>
                <div class="calendar-week">
                    <div class="calendar-week-item">æ—¥</div>
                    <div class="calendar-week-item">ä¸€</div>
                    <div class="calendar-week-item">äºŒ</div>
                    <div class="calendar-week-item">ä¸‰</div>
                    <div class="calendar-week-item">å››</div>
                    <div class="calendar-week-item">äº”</div>
                    <div class="calendar-week-item">å…­</div>
                </div>
                <div class="calendar-wrap" id="calendarWrap">
                    <div class="calendar-days" id="calendarDays"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let password = '0517'; // åˆå§‹å¯†ç 
        let currentType = 'expense';
        let selectedCate = '';
        let longPressTimer = null;
        // åˆ†ç±»æ•°æ®ï¼ˆå«æ–°å¢çš„æŒ‡å®šåˆ†ç±»ï¼‰
        let categories = JSON.parse(localStorage.getItem('phoneCates')) || [
            'é¤é¥®ğŸœ', 'äº¤é€šğŸšŒ', 'å¨±ä¹ğŸ¬', 'å­¦ä¹ ğŸ“š',
            'è´­ç‰©ğŸ›ï¸', 'æˆ¿ç§ŸğŸ ', 'å·¥èµ„ğŸ’¼', 'å…¶ä»–ğŸ”§',
            'æ—¥ç”¨ğŸ§´', 'è”¬èœğŸ¥¬', 'æ°´æœğŸ', 'é¥®æ–™ğŸ¥¤',
            'å®¶åº­ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', 'ç¤¾äº¤ğŸ‘«', 'æ—…è¡Œâœˆï¸', 'åŒ»ç–—ğŸ’Š',
            'æèµ ğŸ', 'è¿˜æ¬¾ğŸ’°', 'å€Ÿå‡ºğŸ“¤'
        ];
        // åˆ†ç±»ä¸å›¾æ ‡æ˜ å°„
        const cateIcons = {
            'é¤é¥®': 'ğŸœ', 'äº¤é€š': 'ğŸšŒ', 'å¨±ä¹': 'ğŸ¬', 'å­¦ä¹ ': 'ğŸ“š',
            'è´­ç‰©': 'ğŸ›ï¸', 'æˆ¿ç§Ÿ': 'ğŸ ', 'å·¥èµ„': 'ğŸ’¼', 'å…¶ä»–': 'ğŸ”§',
            'æ—¥ç”¨': 'ğŸ§´', 'è”¬èœ': 'ğŸ¥¬', 'æ°´æœ': 'ğŸ', 'é¥®æ–™': 'ğŸ¥¤',
            'å®¶åº­': 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', 'ç¤¾äº¤': 'ğŸ‘«', 'æ—…è¡Œ': 'âœˆï¸', 'åŒ»ç–—': 'ğŸ’Š',
            'æèµ ': 'ğŸ', 'è¿˜æ¬¾': 'ğŸ’°', 'å€Ÿå‡º': 'ğŸ“¤',
            'å¥¶èŒ¶': 'ğŸ¥¤', 'æ¸¸æˆ': 'ğŸ®', 'è¯è´¹': 'ğŸ“±', 'å’–å•¡': 'â˜•',
            'ç¤¼ç‰©': 'ğŸ', 'æ±½è½¦': 'ğŸš—', 'ç¾å¦†': 'ğŸ’„', 'é›¶é£Ÿ': 'ğŸ”', 'éŸ³ä¹': 'ğŸµ'
        };
        // è´¦å•æ•°æ®
        let bills = JSON.parse(localStorage.getItem('phoneBills')) || [];
        // é¢„ç®—æ•°æ®ï¼ˆæ ¸å¿ƒï¼šä»…å­˜å‚¨æ‰‹åŠ¨æ·»åŠ çš„é¢„ç®—ï¼Œåˆå§‹ä¸ºç©ºï¼‰
        let monthlyBudgets = JSON.parse(localStorage.getItem('monthlyBudgets')) || {};
        // æ»‘åŠ¨ç›¸å…³å˜é‡
        let startX = 0; 
        let currentBillId = ''; 
        // æ—¥å†ç›¸å…³å˜é‡
        let currentCalendarDate = new Date();
        let selectedDate = new Date();
        let touchStartX = 0;
        let touchEndX = 0;
        let touchStartTime = 0; 
        let isDateClick = false;
        const SWIPE_THRESHOLD = 100;
        const SWIPE_TIME_THRESHOLD = 250;

        // ========== å·¥å…·å‡½æ•° ==========
        // æ ¼å¼åŒ–æ—¥æœŸä¸ºYYYY-MM-DD
        function formatDateToYMD(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // è·å–å½“å‰å¹´æœˆæ ‡è¯†ï¼ˆç”¨äºé¢„ç®—å­˜å‚¨ï¼‰
        function getCurrentMonthKey() {
            const year = new Date().getFullYear();
            const month = String(new Date().getMonth() + 1).padStart(2, '0');
            return `${year}-${month}`;
        }

        // ========== å¯†ç é”åŠŸèƒ½ ==========
        function nextInput(input) {
            const inputs = document.querySelectorAll('.password-input');
            const index = Array.from(inputs).indexOf(input);
            if (input.value && index < 3) {
                inputs[index + 1].focus();
            }
        }
        function checkPassword() {
            const inputs = document.querySelectorAll('.password-input');
            const inputPwd = Array.from(inputs).map(i => i.value).join('');
            
            if (inputPwd.length === 4) {
                if (inputPwd === password) {
                    document.getElementById('lockScreen').style.display = 'none';
                    document.getElementById('mainPage').style.display = 'block';
                    initCalendarSelect();
                    renderHomePage();
                    renderBudgets(); // åˆå§‹åŒ–é¢„ç®—å±•ç¤º
                } else {
                    document.getElementById('alertText').textContent = 'æ•°å­—å¯†ç é”™è¯¯';
                    document.getElementById('customAlert').style.display = 'flex';
                }
            }
        }
        function closeAlert() {
            document.getElementById('customAlert').style.display = 'none';
            const inputs = document.querySelectorAll('.password-input');
            inputs.forEach(input => input.value = '');
            inputs[0].focus();
        }

        // ========== æ—¥å†åŠŸèƒ½ ==========
        function openCalendarModal() {
            document.getElementById('calendarModal').classList.add('show');
            renderCalendar();
            const calendarWrap = document.getElementById('calendarWrap');
            calendarWrap.addEventListener('touchstart', handleCalendarTouchStart);
            calendarWrap.addEventListener('touchmove', handleCalendarTouchMove);
            calendarWrap.addEventListener
