<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <!-- æ ¸å¿ƒï¼šä¼˜åŒ–iOSè§†å£é€‚é…ï¼Œè§£å†³æ ·å¼/ç„¦ç‚¹é—®é¢˜ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>å¦ä¸€ä¸ªæˆ‘ - è®°è´¦APP</title>
  <style>
    /* å…¨å±€æ ·å¼ï¼šé€‚é…iOSï¼Œå¼ºåˆ¶é«˜åº¦100% */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      -webkit-tap-highlight-color: transparent; /* å–æ¶ˆiOSç‚¹å‡»é«˜äº® */
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }
    .page {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      padding: 20px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch; /* iOSå¼¹æ€§æ»šåŠ¨ */
    }
    /* å¯†ç é”é¡µé¢ï¼šiOSä¼˜å…ˆæ˜¾ç¤ºï¼Œå±‚çº§æœ€é«˜ */
    #password-page {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background-color: #f5f5f7;
      z-index: 9999;
    }
    #password-page h2 {
      font-size: 32px;
      margin-bottom: 40px;
      color: #1d1d1f;
    }
    .password-container {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }
    /* æ ¸å¿ƒï¼šiOSé€‚é…è¾“å…¥æ¡†ï¼Œæ”¹ç”¨textç±»å‹+æ•°å­—è¿‡æ»¤ */
    .password-input {
      width: 50px;
      height: 50px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      text-align: center;
      font-size: 24px;
      outline: none;
      -webkit-appearance: none; /* å–æ¶ˆiOSé»˜è®¤æ ·å¼ */
      appearance: none;
      caret-color: #007aff;
    }
    .password-input:focus {
      border-color: #007aff;
    }
    .error-tip {
      color: #ff3b30;
      font-size: 14px;
      display: none;
      margin-top: 10px;
    }
    /* ä¸»é¡µé¢ï¼šé»˜è®¤éšè— */
    #main-page {
      display: none;
      background-color: #f5f5f7;
      z-index: 998;
    }
    .main-header {
      text-align: center;
      padding: 15px 0;
      font-size: 24px;
      font-weight: 600;
      color: #1d1d1f;
    }
    /* æ”¶æ”¯ç»Ÿè®¡å¡ç‰‡ */
    .stats-card {
      background-color: #fff;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .stats-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 16px;
    }
    .stats-item:last-child {
      margin-bottom: 0;
    }
    .expense {
      color: #ff3b30;
    }
    .income {
      color: #34c759;
    }
    .balance {
      color: #007aff;
      font-weight: 600;
    }
    /* é¢„ç®—åŒºåŸŸ */
    .budget-section {
      background-color: #fff;
      border-radius: 16px;
      padding: 15px 20px;
      margin-bottom: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .budget-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .budget-title {
      font-size: 18px;
      font-weight: 600;
      color: #1d1d1f;
    }
    .set-budget-btn {
      font-size: 14px;
      color: #007aff;
      border: none;
      background: none;
      cursor: pointer;
    }
    .budget-list {
      max-height: 150px;
      overflow-y: auto;
    }
    .budget-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    .budget-item:last-child {
      border-bottom: none;
    }
    .budget-category {
      font-size: 15px;
    }
    .budget-usage {
      font-size: 14px;
    }
    .budget-surplus {
      color: #34c759;
    }
    .budget-overspend {
      color: #ff3b30;
    }
    /* æ—¥æœŸæç¤º */
    .date-tip {
      font-size: 16px;
      margin: 10px 0;
      color: #8e8e93;
    }
    /* è´¦å•åˆ—è¡¨ */
    .bill-list {
      background-color: #fff;
      border-radius: 16px;
      padding: 10px 0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 15px;
    }
    .bill-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 20px;
      border-bottom: 1px solid #f0f0f0;
      position: relative;
      transition: transform 0.3s ease;
    }
    .bill-item:last-child {
      border-bottom: none;
    }
    .bill-category {
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .bill-amount {
      font-size: 16px;
    }
    .bill-amount.expense {
      color: #ff3b30;
    }
    .bill-amount.income {
      color: #34c759;
    }
    .bill-delete {
      position: absolute;
      right: 0;
      width: 60px;
      height: 100%;
      background-color: #ff3b30;
      border: none;
      border-radius: 0 16px 16px 0;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .bill-empty {
      text-align: center;
      padding: 30px 0;
      color: #8e8e93;
      font-size: 15px;
    }
    /* åº•éƒ¨åŠŸèƒ½æŒ‰é’®ï¼šiOSé€‚é… */
    .bottom-btns {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
      z-index: 99;
    }
    .func-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: #007aff;
      color: #fff;
      border: none;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 10px rgba(0,122,255,0.5);
      -webkit-appearance: none;
      appearance: none;
    }
    /* å¼¹çª—æ ·å¼ï¼šiOSé€‚é…å±‚çº§ */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      -webkit-overflow-scrolling: touch;
    }
    .modal-content {
      background-color: #fff;
      border-radius: 20px;
      width: 90%;
      max-width: 400px;
      padding: 20px;
      max-height: 80vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #f0f0f0;
    }
    .modal-title {
      font-size: 18px;
      font-weight: 600;
    }
    .close-modal {
      border: none;
      background: none;
      font-size: 20px;
      color: #8e8e93;
      cursor: pointer;
      -webkit-appearance: none;
      appearance: none;
    }
    .form-item {
      margin-bottom: 15px;
    }
    .form-label {
      display: block;
      margin-bottom: 5px;
      font-size: 15px;
      color: #1d1d1f;
    }
    .form-input {
      width: 100%;
      padding: 10px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
      outline: none;
      -webkit-appearance: none;
      appearance: none;
    }
    .form-input:focus {
      border-color: #007aff;
    }
    .radio-group {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
    }
    .radio-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .category-list {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 15px;
      max-height: 150px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    .category-item {
      padding: 8px 15px;
      border: 1px solid #e0e0e0;
      border-radius: 20px;
      font-size: 14px;
      cursor: pointer;
    }
    .category-item.active {
      background-color: #007aff;
      color: #fff;
      border-color: #007aff;
    }
    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    .confirm-btn {
      flex: 1;
      padding: 10px;
      background-color: #007aff;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      -webkit-appearance: none;
      appearance: none;
    }
    .cancel-btn {
      flex: 1;
      padding: 10px;
      background-color: #f5f5f7;
      color: #1d1d1f;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      -webkit-appearance: none;
      appearance: none;
    }
    /* æ—¥å†å¼¹çª—æ ·å¼ */
    .calendar {
      width: 100%;
    }
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .calendar-month {
      font-size: 16px;
      font-weight: 600;
    }
    .calendar-btn {
      border: none;
      background: none;
      font-size: 18px;
      color: #007aff;
      cursor: pointer;
      -webkit-appearance: none;
      appearance: none;
    }
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
    }
    .calendar-day {
      text-align: center;
      padding: 8px;
      font-size: 14px;
      border-radius: 50%;
      cursor: pointer;
      position: relative;
    }
    .calendar-day.today {
      border: 2px solid #007aff;
    }
    .calendar-day.selected {
      background-color: #007aff;
      color: #fff;
    }
    .calendar-day.has-bill::after {
      content: '';
      position: absolute;
      bottom: 2px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background-color: #ff3b30;
    }
    /* é¢„ç®—è®¾ç½®å¼¹çª— */
    .budget-form-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    .budget-form-label {
      font-size: 15px;
    }
    .budget-form-input {
      width: 100px;
      padding: 5px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      text-align: right;
      -webkit-appearance: none;
      appearance: none;
    }
    /* åˆ é™¤åˆ†ç±»æç¤ºæ ·å¼ */
    .category-tip {
      font-size: 12px;
      color: #8e8e93;
      margin-top: 5px;
      text-align: center;
    }
  </style>
</head>
<body>
  <!-- å¯†ç é”é¡µé¢ -->
  <div id="password-page" class="page">
    <h2>å¦ä¸€ä¸ªæˆ‘</h2>
    <div class="password-container">
      <!-- æ ¸å¿ƒï¼šiOSæ”¹ç”¨textç±»å‹ï¼Œé¿å…telé”®ç›˜å…¼å®¹æ€§é—®é¢˜ -->
      <input type="text" class="password-input" maxlength="1" placeholder="*" data-index="0">
      <input type="text" class="password-input" maxlength="1" placeholder="*" data-index="1">
      <input type="text" class="password-input" maxlength="1" placeholder="*" data-index="2">
      <input type="text" class="password-input" maxlength="1" placeholder="*" data-index="3">
    </div>
    <div class="error-tip">å¯†ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥</div>
  </div>

  <!-- ä¸»é¡µé¢ -->
  <div id="main-page" class="page">
    <div class="main-header">å¦ä¸€ä¸ªæˆ‘</div>
    
    <!-- æ”¶æ”¯ç»Ÿè®¡å¡ç‰‡ -->
    <div class="stats-card">
      <div class="stats-item">
        <span>æœ¬æœˆæ”¯å‡º</span>
        <span class="expense" id="monthly-expense">Â¥0.00</span>
      </div>
      <div class="stats-item">
        <span>æœ¬æœˆæ”¶å…¥</span>
        <span class="income" id="monthly-income">Â¥0.00</span>
      </div>
      <div class="stats-item">
        <span>è´¦æˆ·ä½™é¢</span>
        <span class="balance" id="account-balance">Â¥0.00</span>
      </div>
    </div>

    <!-- é¢„ç®—åŒºåŸŸ -->
    <div class="budget-section">
      <div class="budget-header">
        <span class="budget-title">æœ¬æœˆåˆ†ç±»é¢„ç®—</span>
        <button class="set-budget-btn" id="set-budget-btn">è®¾ç½®é¢„ç®—</button>
      </div>
      <div class="budget-list" id="budget-list">
        <div style="text-align:center; padding:10px; color:#8e8e93;">æš‚æ— é¢„ç®—è®¾ç½®</div>
      </div>
    </div>

    <!-- æ—¥æœŸæç¤º -->
    <div class="date-tip" id="current-date-tip">å½“å‰é€‰ä¸­ï¼š2025-12-22</div>

    <!-- è´¦å•åˆ—è¡¨ -->
    <div class="bill-list" id="bill-list">
      <div class="bill-empty">æš‚æ— è´¦å•ï¼Œç‚¹å‡»+å¼€å§‹è®°å½•</div>
    </div>

    <!-- åº•éƒ¨åŠŸèƒ½æŒ‰é’® -->
    <div class="bottom-btns">
      <button class="func-btn" id="add-bill-btn">+</button>
      <button class="func-btn" id="calendar-btn">æ—¥</button>
    </div>
  </div>

  <!-- è®°è´¦å¼¹çª— -->
  <div class="modal" id="bill-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">æ–°å¢è´¦å•</h3>
        <button class="close-modal" data-modal="bill-modal">Ã—</button>
      </div>
      <div class="radio-group">
        <label class="radio-item">
          <input type="radio" name="bill-type" value="expense" checked> æ”¯å‡º
        </label>
        <label class="radio-item">
          <input type="radio" name="bill-type" value="income"> æ”¶å…¥
        </label>
      </div>
      <div class="form-item">
        <label class="form-label">é‡‘é¢ï¼ˆå…ƒï¼‰</label>
        <input type="number" class="form-input" id="bill-amount" min="0.01" step="0.01" placeholder="è¯·è¾“å…¥é‡‘é¢">
      </div>
      <div class="form-item">
        <label class="form-label">åˆ†ç±»</label>
        <div class="category-list" id="bill-category-list">
          <!-- åˆ†ç±»åˆ—è¡¨åŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div class="category-tip">é•¿æŒ‰åˆ†ç±»å¯åˆ é™¤ï¼ˆè‡³å°‘ä¿ç•™1ä¸ªåˆ†ç±»ï¼‰</div>
        <button class="confirm-btn" style="margin-top: 10px;" id="add-category-btn">æ–°å¢åˆ†ç±»</button>
      </div>
      <div class="btn-group">
        <button class="confirm-btn" id="save-bill-btn">ä¿å­˜</button>
        <button class="cancel-btn" data-modal="bill-modal">å–æ¶ˆ</button>
      </div>
    </div>
  </div>

  <!-- æ–°å¢åˆ†ç±»å¼¹çª— -->
  <div class="modal" id="category-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">æ–°å¢åˆ†ç±»</h3>
        <button class="close-modal" data-modal="category-modal">Ã—</button>
      </div>
      <div class="form-item">
        <label class="form-label">åˆ†ç±»åç§°</label>
        <input type="text" class="form-input" id="category-name" placeholder="è¯·è¾“å…¥åˆ†ç±»åç§°ï¼ˆå¦‚ï¼šè´­ç‰©ï¼‰">
      </div>
      <div class="btn-group">
        <button class="confirm-btn" id="save-category-btn">ä¿å­˜</button>
        <button class="cancel-btn" data-modal="category-modal">å–æ¶ˆ</button>
      </div>
    </div>
  </div>

  <!-- é¢„ç®—è®¾ç½®å¼¹çª— -->
  <div class="modal" id="budget-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">è®¾ç½®åˆ†ç±»é¢„ç®—</h3>
        <button class="close-modal" data-modal="budget-modal">Ã—</button>
      </div>
      <div id="budget-form-list">
        <!-- é¢„ç®—è¡¨å•åŠ¨æ€ç”Ÿæˆ -->
      </div>
      <div class="btn-group">
        <button class="confirm-btn" id="save-budget-btn">ä¿å­˜é¢„ç®—</button>
        <button class="cancel-btn" data-modal="budget-modal">å–æ¶ˆ</button>
      </div>
    </div>
  </div>

  <!-- æ—¥å†å¼¹çª— -->
  <div class="modal" id="calendar-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">é€‰æ‹©æ—¥æœŸ</h3>
        <button class="close-modal" data-modal="calendar-modal">Ã—</button>
      </div>
      <div class="calendar">
        <div class="calendar-header">
          <button class="calendar-btn" id="prev-month-btn">â†</button>
          <span class="calendar-month" id="current-calendar-month">2025å¹´12æœˆ</span>
          <button class="calendar-btn" id="next-month-btn">â†’</button>
        </div>
        <div class="calendar-grid" id="calendar-grid">
          <!-- æ—¥å†ç½‘æ ¼åŠ¨æ€ç”Ÿæˆ -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // æ ¸å¿ƒé…ç½®
    const DEFAULT_PASSWORD = '0517';
    const DEFAULT_CATEGORIES = [
      { name: 'è´­ç‰©', icon: 'ğŸ›’' },
      { name: 'é›¶é£Ÿ', icon: 'ğŸŸ' },
      { name: 'é¤é¥®', icon: 'ğŸœ' },
      { name: 'äº¤é€š', icon: 'ğŸšŒ' },
      { name: 'å¨±ä¹', icon: 'ğŸ¬' },
      { name: 'ä½æˆ¿', icon: 'ğŸ ' },
      { name: 'æ°´ç”µ', icon: 'ğŸ’§' },
      { name: 'é€šè®¯', icon: 'ğŸ“±' },
      { name: 'åŒ»ç–—', icon: 'ğŸ’Š' },
      { name: 'å­¦ä¹ ', icon: 'ğŸ“š' },
      { name: 'ç¤¼ç‰©', icon: 'ğŸ' },
      { name: 'å¥èº«', icon: 'ğŸ‹ï¸' },
      { name: 'ç¾å¦†', icon: 'ğŸ’„' },
      { name: 'å® ç‰©', icon: 'ğŸ±' },
      { name: 'æ—…è¡Œ', icon: 'âœˆï¸' },
      { name: 'çƒŸé…’', icon: 'ğŸº' },
      { name: 'ä¹¦ç±', icon: 'ğŸ“–' },
      { name: 'æ•°ç ', icon: 'ğŸ“±' },
      { name: 'å…¶ä»–', icon: 'ğŸ”§' }
    ];

    // å…¨å±€DOMç¼“å­˜
    let passwordInputs = [];
    let passwordPage = null;
    let mainPage = null;
    let errorTip = null;
    
    // å…¨å±€çŠ¶æ€
    let currentDate = new Date();
    let selectedCategory = '';
    let currentCalendarMonth = new Date();

    // ========== iOSæ ¸å¿ƒé€‚é…ï¼šåˆå§‹åŒ–DOM + å¼ºåˆ¶èšç„¦ ==========
    function initDOM() {
      passwordInputs = document.querySelectorAll('.password-input');
      passwordPage = document.getElementById('password-page');
      mainPage = document.getElementById('main-page');
      errorTip = document.querySelector('.error-tip');
      
      // iOSå¼ºåˆ¶éªŒè¯DOM
      if (!passwordInputs || passwordInputs.length !== 4 || !passwordPage || !mainPage) {
        alert('é¡µé¢åŠ è½½å¼‚å¸¸ï¼Œè¯·åˆ·æ–°é‡è¯•ï¼');
        return false;
      }
      return true;
    }

    // iOSé€‚é…ï¼šé¡µé¢åŠ è½½åç«‹å³åˆå§‹åŒ–ï¼ˆç”¨æˆ·äº¤äº’å†…è§¦å‘ç„¦ç‚¹ï¼‰
    document.addEventListener('DOMContentLoaded', function() {
      if (!initDOM()) return;
      
      // iOSæ ¸å¿ƒï¼šå»¶è¿Ÿèšç„¦ï¼ˆè§£å†³Safariç„¦ç‚¹é™åˆ¶ï¼‰
      setTimeout(() => {
        passwordInputs[0].focus();
        passwordInputs[0].select();
      }, 100);
      
      initLocalStorage();
      bindPasswordEvents();
      initMainPage();
      initModalEvents();
      initCalendar();
      updatePageData();
    });

    // åˆå§‹åŒ–æœ¬åœ°å­˜å‚¨
    function initLocalStorage() {
      if (!localStorage.getItem('phoneCates')) {
        localStorage.setItem('phoneCates', JSON.stringify(DEFAULT_CATEGORIES));
      } else {
        const currentCates = JSON.parse(localStorage.getItem('phoneCates'));
        if (currentCates.length === 0) {
          localStorage.setItem('phoneCates', JSON.stringify(DEFAULT_CATEGORIES));
        }
      }
      if (!localStorage.getItem('phoneBills')) {
        localStorage.setItem('phoneBills', JSON.stringify([]));
      }
      if (!localStorage.getItem('monthlyBudgets')) {
        localStorage.setItem('monthlyBudgets', JSON.stringify({}));
      }
    }

    // ========== iOSæ ¸å¿ƒé€‚é…ï¼šå¯†ç äº‹ä»¶ç»‘å®šï¼ˆå…¼å®¹Safariäº‹ä»¶ï¼‰ ==========
    function bindPasswordEvents() {
      passwordInputs.forEach((input, index) => {
        // 1. inputäº‹ä»¶ï¼šiOSä¼˜å…ˆï¼Œè¿‡æ»¤éæ•°å­—
        input.addEventListener('input', function() {
          // iOSä¸¥æ ¼è¿‡æ»¤ï¼šåªä¿ç•™0-9
          this.value = this.value.replace(/[^0-9]/g, '').slice(0, 1);
          
          // iOSè‡ªåŠ¨è·³æ ¼ï¼ˆå»¶è¿Ÿé€‚é…ï¼‰
          if (this.value && index < 3) {
            setTimeout(() => {
              passwordInputs[index + 1].focus();
              passwordInputs[index + 1].select();
            }, 50);
          }
          
          checkPasswordImmediately();
        });

        // 2. iOSé”®ç›˜äº‹ä»¶é€‚é…ï¼ˆå…¼å®¹Backspace/backspaceï¼‰
        input.addEventListener('keydown', function(e) {
          // é€€æ ¼é”®é€‚é…ï¼šiOSå¯èƒ½æ˜¯å°å†™backspace
          const isBackspace = e.key === 'Backspace' || e.key === 'backspace';
          if (isBackspace && this.value === '' && index > 0) {
            passwordInputs[index - 1].focus();
            passwordInputs[index - 1].value = '';
            e.preventDefault();
          }
          
          // é˜»æ­¢éæ•°å­—è¾“å…¥ï¼ˆiOSå…¼å®¹ï¼‰
          if (!/^\d$/.test(e.key) && !isBackspace && e.key !== 'Tab' && e.key !== 'Enter') {
            e.preventDefault();
          }
          
          // iOSå›è½¦éªŒè¯
          if (e.key === 'Enter') {
            checkPasswordImmediately();
            e.preventDefault();
          }
        });

        // 3. iOSè§¦æ‘¸èšç„¦é€‚é…
        input.addEventListener('touchstart', function() {
          this.focus();
          this.select();
        });

        // 4. èšç„¦é€‰ä¸­å†…å®¹ï¼ˆiOSä½“éªŒä¼˜åŒ–ï¼‰
        input.addEventListener('focus', function() {
          setTimeout(() => {
            this.select();
          }, 10);
        });
      });
    }

    // ========== iOSæ ¸å¿ƒé€‚é…ï¼šå¼ºåˆ¶DOMæ›´æ–° + é‡ç»˜ ==========
    function checkPasswordImmediately() {
      // æ‹¼æ¥å¯†ç ï¼ˆiOSå¤„ç†ç©ºå€¼ï¼‰
      let inputPwd = '';
      passwordInputs.forEach(input => {
        inputPwd += input.value.trim() || '';
      });

      errorTip.style.display = 'none';

      if (inputPwd.length !== 4) return;

      // å¯†ç æ­£ç¡®ï¼šiOSå¼ºåˆ¶åˆ‡æ¢é¡µé¢
      if (inputPwd === DEFAULT_PASSWORD) {
        // 1. éšè—é”™è¯¯æç¤º
        errorTip.style.display = 'none';
        
        // 2. iOSæ ¸å¿ƒï¼šå¼ºåˆ¶ä¿®æ”¹æ ·å¼ï¼ˆç»•è¿‡!importanté™åˆ¶ï¼‰
        passwordPage.style.display = 'none';
        mainPage.style.display = 'block';
        
        // 3. å¼ºåˆ¶é‡ç»˜ï¼ˆè§£å†³iOSæ¸²æŸ“å»¶è¿Ÿï¼‰
        mainPage.offsetHeight; // è§¦å‘reflow
        
        // 4. å»¶è¿Ÿç¡®è®¤ + æ»šåŠ¨åˆ°é¡¶éƒ¨
        setTimeout(() => {
          // éšè—å¯†ç é¡µï¼ˆå½»åº•ï¼‰
          passwordPage.style.visibility = 'hidden';
          passwordPage.style.zIndex = '0';
          // æ˜¾ç¤ºä¸»é¡µ
          mainPage.style.zIndex = '999';
          mainPage.scrollTop = 0;
          // iOSæ”¶èµ·é”®ç›˜
          passwordInputs.forEach(input => input.blur());
        }, 50);
      } else {
        // å¯†ç é”™è¯¯ï¼šiOSæç¤º + æ¸…ç©º
        errorTip.style.display = 'block';
        setTimeout(() => {
          clearAllPassword();
          errorTip.style.display = 'none';
        }, 1500);
      }
    }

    // iOSé€‚é…ï¼šæ¸…ç©ºå¯†ç  + é‡æ–°èšç„¦
    function clearAllPassword() {
      passwordInputs.forEach((input, index) => {
        input.value = '';
        if (index === 0) {
          setTimeout(() => {
            input.focus();
            input.select();
          }, 50);
        }
      });
    }

    // åˆå§‹åŒ–ä¸»é¡µé¢
    function initMainPage() {
      renderCategoryList();
      renderBudgetList();
      
      // iOSæŒ‰é’®ç‚¹å‡»é€‚é…ï¼ˆæ·»åŠ touchstartï¼‰
      const addBillBtn = document.getElementById('add-bill-btn');
      addBillBtn.addEventListener('click', () => {
        openModal('bill-modal');
        renderCategoryList();
      });
      addBillBtn.addEventListener('touchstart', (e) => {
        e.preventDefault();
        openModal('bill-modal');
        renderCategoryList();
      });

      const calendarBtn = document.getElementById('calendar-btn');
      calendarBtn.addEventListener('click', () => {
        openModal('calendar-modal');
        renderCalendar(currentCalendarMonth);
      });
      calendarBtn.addEventListener('touchstart', (e) => {
        e.preventDefault();
        openModal('calendar-modal');
        renderCalendar(currentCalendarMonth);
      });

      document.getElementById('set-budget-btn').addEventListener('click', () => {
        openModal('budget-modal');
        renderBudgetForm();
      });
      document.getElementById('add-category-btn').addEventListener('click', () => openModal('category-modal'));
      document.getElementById('save-bill-btn').addEventListener('click', saveBill);
      document.getElementById('save-category-btn').addEventListener('click', saveCategory);
      document.getElementById('save-budget-btn').addEventListener('click', saveBudget);
    }

    // iOSå¼¹çª—äº‹ä»¶é€‚é…
    function initModalEvents() {
      document.querySelectorAll('.close-modal, .cancel-btn').forEach(btn => {
        // å…¼å®¹click + touchstart
        btn.addEventListener('click', closeModalHandler);
        btn.addEventListener('touchstart', (e) => {
          e.preventDefault();
          closeModalHandler.call(btn);
        });
      });

      document.getElementById('prev-month-btn').addEventListener('click', () => {
        currentCalendarMonth.setMonth(currentCalendarMonth.getMonth() - 1);
        renderCalendar(currentCalendarMonth);
      });
      document.getElementById('next-month-btn').addEventListener('click', () => {
        currentCalendarMonth.setMonth(currentCalendarMonth.getMonth() + 1);
        renderCalendar(currentCalendarMonth);
      });
    }

    // iOSå¼¹çª—å…³é—­å¤„ç†
    function closeModalHandler() {
      const modalId = this.getAttribute('data-modal');
      closeModal(modalId);
    }

    // å¼¹çª—æ“ä½œ
    function openModal(modalId) {
      const modal = document.getElementById(modalId);
      modal.style.display = 'flex';
      // iOSé‡ç»˜å¼¹çª—
      modal.offsetHeight;
    }
    function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      modal.style.display = 'none';
    }

    // æ¸²æŸ“åˆ†ç±»åˆ—è¡¨
    function renderCategoryList() {
      const categories = JSON.parse(localStorage.getItem('phoneCates'));
      const categoryList = document.getElementById('bill-category-list');
      categoryList.innerHTML = '';
      
      categories.forEach(category => {
        const item = document.createElement('div');
        item.className = 'category-item';
        item.dataset.name = category.name;
        item.innerHTML = `${category.icon} ${category.name}`;
        
        // iOSç‚¹å‡» + è§¦æ‘¸é€‚é…
        item.addEventListener('click', () => {
          document.querySelectorAll('.category-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          selectedCategory = category.name;
        });
        item.addEventListener('touchstart', (e) => {
          e.preventDefault();
          document.querySelectorAll('.category-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          selectedCategory = category.name;
        });
        
        categoryList.appendChild(item);

        // é•¿æŒ‰åˆ é™¤åˆ†ç±»ï¼ˆiOSè§¦æ‘¸äº‹ä»¶é€‚é…ï¼‰
        let longPressTimer;
        item.addEventListener('touchstart', () => {
          longPressTimer = setTimeout(() => {
            deleteCategoryConfirm(category.name);
          }, 800);
        });
        item.addEventListener('touchend', () => clearTimeout(longPressTimer));
        item.addEventListener('touchcancel', () => clearTimeout(longPressTimer));
        item.addEventListener('mousedown', () => {
          longPressTimer = setTimeout(() => {
            deleteCategoryConfirm(category.name);
          }, 800);
        });
        item.addEventListener('mouseup', () => clearTimeout(longPressTimer));
      });

      // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªåˆ†ç±»
      if (categories.length > 0) {
        categoryList.firstChild.classList.add('active');
        selectedCategory = categories[0].name;
      }
    }

    // åˆ é™¤åˆ†ç±»ç¡®è®¤ï¼ˆå¼ºåˆ¶ä¿ç•™è‡³å°‘ä¸€ä¸ªï¼‰
    function deleteCategoryConfirm(categoryName) {
      const categories = JSON.parse(localStorage.getItem('phoneCates'));
      
      if (categories.length <= 1) {
        alert('è‡³å°‘éœ€è¦ä¿ç•™ä¸€ä¸ªåˆ†ç±»ï¼Œæ— æ³•åˆ é™¤ï¼');
        return;
      }
      
      if (confirm(`ç¡®å®šåˆ é™¤åˆ†ç±»ã€${categoryName}ã€‘å—ï¼Ÿåˆ é™¤åè¯¥åˆ†ç±»ä¸‹çš„è´¦å•ä¸ä¼šè¢«åˆ é™¤ï¼Œä½†åˆ†ç±»åç§°å°†æ˜¾ç¤ºä¸º"å…¶ä»–"ã€‚`)) {
        deleteCategory(categoryName);
      }
    }

    // åˆ é™¤åˆ†ç±»
    function deleteCategory(categoryName) {
      let categories = JSON.parse(localStorage.getItem('phoneCates'));
      categories = categories.filter(c => c.name !== categoryName);
      localStorage.setItem('phoneCates', JSON.stringify(categories));
      
      // åŒæ­¥æ›´æ–°è´¦å•åˆ†ç±»
      let bills = JSON.parse(localStorage.getItem('phoneBills'));
      bills = bills.map(bill => {
        if (bill.category === categoryName) {
          return { ...bill, category: 'å…¶ä»–' };
        }
        return bill;
      });
      localStorage.setItem('phoneBills', JSON.stringify(bills));
      
      renderCategoryList();
      renderBudgetForm();
      updatePageData();
    }

    // ä¿å­˜åˆ†ç±»
    function saveCategory() {
      const categoryName = document.getElementById('category-name').value.trim();
      if (!categoryName) {
        alert('è¯·è¾“å…¥åˆ†ç±»åç§°ï¼');
        return;
      }
      
      const categories = JSON.parse(localStorage.getItem('phoneCates'));
      if (categories.some(c => c.name === categoryName)) {
        alert('è¯¥åˆ†ç±»å·²å­˜åœ¨ï¼');
        return;
      }
      
      const newCategory = { name: categoryName, icon: getRandomIcon() };
      categories.push(newCategory);
      localStorage.setItem('phoneCates', JSON.stringify(categories));
      
      renderCategoryList();
      // é€‰ä¸­æ–°å¢çš„åˆ†ç±»
      const categoryItems = document.querySelectorAll('.category-item');
      categoryItems.forEach(item => {
        if (item.dataset.name === categoryName) {
          item.classList.add('active');
          selectedCategory = categoryName;
        } else {
          item.classList.remove('active');
        }
      });
      
      closeModal('category-modal');
      document.getElementById('category-name').value = '';
    }

    // éšæœºå›¾æ ‡
    function getRandomIcon() {
      const icons = ['ğŸ”¹', 'ğŸ”¸', 'â­', 'âœ¨', 'ğŸ€', 'ğŸˆ', 'ğŸ”§', 'ğŸ“Œ'];
      return icons[Math.floor(Math.random() * icons.length)];
    }

    // ä¿å­˜è´¦å•
    function saveBill() {
      const amount = parseFloat(document.getElementById('bill-amount').value);
      const billType = document.querySelector('input[name="bill-type"]:checked').value;
      
      if (isNaN(amount) || amount <= 0) {
        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é‡‘é¢ï¼ˆæœ€å°0.01å…ƒï¼‰ï¼');
        return;
      }
      if (!selectedCategory) {
        alert('è¯·é€‰æ‹©åˆ†ç±»ï¼');
        return;
      }
      
      const bills = JSON.parse(localStorage.getItem('phoneBills'));
      const bill = {
        id: Date.now(),
        type: billType,
        amount: amount,
        category: selectedCategory,
        date: formatDate(currentDate),
        time: new Date().toLocaleTimeString()
      };
      
      bills.unshift(bill);
      localStorage.setItem('phoneBills', JSON.stringify(bills));
      updatePageData();
      closeModal('bill-modal');
      document.getElementById('bill-amount').value = '';
    }

    // æ¸²æŸ“é¢„ç®—åˆ—è¡¨
    function renderBudgetList() {
      const budgets = JSON.parse(localStorage.getItem('monthlyBudgets'));
      const budgetList = document.getElementById('budget-list');
      const currentMonthKey = getMonthKey(currentDate);
      const monthBudgets = budgets[currentMonthKey] || {};
      const categories = JSON.parse(localStorage.getItem('phoneCates'));
      
      budgetList.innerHTML = '';
      
      const bills = JSON.parse(localStorage.getItem('phoneBills'));
      const monthBills = bills.filter(b => b.date.startsWith(getMonthKey(currentDate)));
      
      let hasBudget = false;
      for (const [category, budget] of Object.entries(monthBudgets)) {
        if (budget <= 0) continue;
        hasBudget = true;
        
        const usedAmount = monthBills
          .filter(b => b.category === category && b.type === 'expense')
          .reduce((sum, b) => sum + b.amount, 0);
        const surplus = budget - usedAmount;
        
        const item = document.createElement('div');
        item.className = 'budget-item';
        item.innerHTML = `
          <div class="budget-category">${categories.find(c => c.name === category)?.icon || 'ğŸ”¹'} ${category}</div>
          <div class="budget-usage">
            Â¥${usedAmount.toFixed(2)}/${budget.toFixed(2)} 
            <span class="${surplus >= 0 ? 'budget-surplus' : 'budget-overspend'}">
              ${surplus >= 0 ? 'å‰©ä½™' : 'è¶…æ”¯'} Â¥${Math.abs(surplus).toFixed(2)}
            </span>
          </div>
        `;
        budgetList.appendChild(item);
      }
      
      if (!hasBudget) {
        budgetList.innerHTML = '<div style="text-align:center; padding:10px; color:#8e8e93;">æš‚æ— é¢„ç®—è®¾ç½®</div>';
      }
    }

    // æ¸²æŸ“é¢„ç®—è¡¨å•
    function renderBudgetForm() {
      const categories = JSON.parse(localStorage.getItem('phoneCates'));
      const budgets = JSON.parse(localStorage.getItem('monthlyBudgets'));
      const currentMonthKey = getMonthKey(currentDate);
      const monthBudgets = budgets[currentMonthKey] || {};
      const budgetFormList = document.getElementById('budget-form-list');
      
      budgetFormList.innerHTML = '';
      
      categories.forEach(category => {
        const item = document.createElement('div');
        item.className = 'budget-form-item';
        item.innerHTML = `
          <label class="budget-form-label">${category.icon} ${category.name}</label>
          <input type="number" class="budget-form-input" data-category="${category.name}" 
                 min="0.01" step="0.01" value="${monthBudgets[category.name] || ''}" 
                 placeholder="è¾“å…¥é¢„ç®—é‡‘é¢">
        `;
        budgetFormList.appendChild(item);
      });
    }

    // ä¿å­˜é¢„ç®—
    function saveBudget() {
      const budgets = JSON.parse(localStorage.getItem('monthlyBudgets'));
      const currentMonthKey = getMonthKey(currentDate);
      const monthBudgets = {};
      
      document.querySelectorAll('.budget-form-input').forEach(input => {
        const category = input.dataset.category;
        const amount = parseFloat(input.value);
        if (!isNaN(amount) && amount > 0) {
          monthBudgets[category] = amount;
        }
      });
      
      budgets[currentMonthKey] = monthBudgets;
      localStorage.setItem('monthlyBudgets', JSON.stringify(budgets));
      renderBudgetList();
      closeModal('budget-modal');
    }

    // åˆå§‹åŒ–æ—¥å†
    function initCalendar() {
      renderCalendar(currentCalendarMonth);
    }

    // æ¸²æŸ“æ—¥å†
    function renderCalendar(date) {
      const year = date.getFullYear();
      const month = date.getMonth();
      document.getElementById('current-calendar-month').textContent = `${year}å¹´${month + 1}æœˆ`;
      
      const calendarGrid = document.getElementById('calendar-grid');
      calendarGrid.innerHTML = '';
      
      // æ˜ŸæœŸæ ‡é¢˜
      const weekdays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
      weekdays.forEach(day => {
        const header = document.createElement('div');
        header.className = 'calendar-day';
        header.style.fontWeight = '600';
        header.textContent = day;
        calendarGrid.appendChild(header);
      });
      
      // å½“æœˆç¬¬ä¸€å¤©/æœ€åä¸€å¤©
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const firstDayWeek = firstDay.getDay();
      
      // å¡«å……å‰é¢çš„ç©ºç™½
      for (let i = 0; i < firstDayWeek; i++) {
        const empty = document.createElement('div');
        empty.className = 'calendar-day';
        calendarGrid.appendChild(empty);
      }
      
      // æ ‡è®°æœ‰è´¦å•çš„æ—¥æœŸ
      const bills = JSON.parse(localStorage.getItem('phoneBills'));
      const billDates = new Set();
      bills.forEach(bill => {
        if (bill.date.startsWith(`${year}-${String(month + 1).padStart(2, '0')}`)) {
          billDates.add(bill.date.split(' ')[0].split('-')[2]);
        }
      });
      
      // å¡«å……æ—¥æœŸ
      for (let day = 1; day <= lastDay.getDate(); day++) {
        const dateItem = document.createElement('div');
        dateItem.className = 'calendar-day';
        dateItem.textContent = day;
        dateItem.dataset.date = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        
        // æ ‡è®°ä»Šæ—¥
        const today = new Date();
        if (year === today.getFullYear() && month === today.getMonth() && day === today.getDate()) {
          dateItem.classList.add('today');
        }
        
        // æ ‡è®°é€‰ä¸­æ—¥æœŸ
        const selectedDateStr = formatDate(currentDate).split(' ')[0];
        if (dateItem.dataset.date === selectedDateStr) {
          dateItem.classList.add('selected');
        }
        
        // æ ‡è®°æœ‰è´¦å•
        if (billDates.has(String(day).padStart(2, '0'))) {
          dateItem.classList.add('has-bill');
        }
        
        // iOSç‚¹å‡» + è§¦æ‘¸é€‚é…
        dateItem.addEventListener('click', () => {
          currentDate = new Date(dateItem.dataset.date);
          document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('selected'));
          dateItem.classList.add('selected');
          updatePageData();
          closeModal('calendar-modal');
        });
        dateItem.addEventListener('touchstart', (e) => {
          e.preventDefault();
          currentDate = new Date(dateItem.dataset.date);
          document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('selected'));
          dateItem.classList.add('selected');
          updatePageData();
          closeModal('calendar-modal');
        });
        
        calendarGrid.appendChild(dateItem);
      }
    }

    // æ›´æ–°é¡µé¢æ•°æ®
    function updatePageData() {
      document.getElementById('current-date-tip').textContent = `å½“å‰é€‰ä¸­ï¼š${formatDate(currentDate)}`;
      updateStats();
      renderBillList();
      renderBudgetList();
    }

    // æ›´æ–°æ”¶æ”¯ç»Ÿè®¡
    function updateStats() {
      const bills = JSON.parse(localStorage.getItem('phoneBills'));
      const currentMonth = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;
      
      let monthlyExpense = 0;
      let monthlyIncome = 0;
      
      bills.forEach(bill => {
        if (bill.date.startsWith(currentMonth)) {
          if (bill.type === 'expense') {
            monthlyExpense += bill.amount;
          } else {
            monthlyIncome += bill.amount;
          }
        }
      });
      
      document.getElementById('monthly-expense').textContent = `Â¥${monthlyExpense.toFixed(2)}`;
      document.getElementById('monthly-income').textContent = `Â¥${monthlyIncome.toFixed(2)}`;
      document.getElementById('account-balance').textContent = `Â¥${(monthlyIncome - monthlyExpense).toFixed(2)}`;
    }

    // æ¸²æŸ“è´¦å•åˆ—è¡¨
    function renderBillList() {
      const bills = JSON.parse(localStorage.getItem('phoneBills'));
      const billList = document.getElementById('bill-list');
      const targetDate = formatDate(currentDate).split(' ')[0];
      
      const dayBills = bills.filter(bill => bill.date.startsWith(targetDate));
      
      billList.innerHTML = '';
      
      if (dayBills.length === 0) {
        billList.innerHTML = '<div class="bill-empty">æš‚æ— è´¦å•ï¼Œç‚¹å‡»+å¼€å§‹è®°å½•</div>';
        return;
      }
      
      dayBills.forEach(bill => {
        const billItem = document.createElement('div');
        billItem.className = 'bill-item';
        billItem.dataset.id = bill.id;
        
        const categories = JSON.parse(localStorage.getItem('phoneCates'));
        const categoryIcon = categories.find(c => c.name === bill.category)?.icon || 'ğŸ”¹';
        
        billItem.innerHTML = `
          <div class="bill-category">${categoryIcon} ${bill.category}</div>
          <div class="bill-amount ${bill.type}">${bill.type === 'expense' ? '-' : '+'}Â¥${bill.amount.toFixed(2)}</div>
          <button class="bill-delete" style="display:none;">Ã—</button>
        `;
        
        // iOSå·¦æ»‘åˆ é™¤é€‚é…
        let startX = 0;
        let isSliding = false;
        
        billItem.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX;
        });
        
        billItem.addEventListener('touchmove', (e) => {
          const moveX = e.touches[0].clientX;
          const diffX = startX - moveX;
          if (diffX > 0) {
            e.preventDefault();
            const translateX = Math.min(diffX, 60);
            billItem.style.transform = `translateX(-${translateX}px)`;
            billItem.querySelector('.bill-delete').style.display = translateX > 30 ? 'flex' : 'none';
            isSliding = true;
          }
        });
        
        billItem.addEventListener('touchend', () => {
          if (isSliding) {
            const currentX = parseInt(billItem.style.transform.replace('translateX(-', '').replace('px)', '')) || 0;
            if (currentX > 30) {
              billItem.style.transform = 'translateX(-60px)';
              billItem.querySelector('.bill-delete').style.display = 'flex';
            } else {
              billItem.style.transform = 'translateX(0)';
              billItem.querySelector('.bill-delete').style.display = 'none';
            }
            isSliding = false;
          }
        });
        
        // PCç«¯æ¨¡æ‹Ÿå·¦æ»‘
        billItem.addEventListener('mousedown', (e) => {
          startX = e.clientX;
        });
        
        billItem.addEventListener('mousemove', (e) => {
          const moveX = e.clientX;
          const diffX = startX - moveX;
          if (diffX > 0) {
            const translateX = Math.min(diffX, 60);
            billItem.style.transform = `translateX(-${translateX}px)`;
            billItem.querySelector('.bill-delete').style.display = translateX > 30 ? 'flex' : 'none';
            isSliding = true;
          }
        });
        
        billItem.addEventListener('mouseup', () => {
          if (isSliding) {
            const currentX = parseInt(billItem.style.transform.replace('translateX(-', '').replace('px)', '')) || 0;
            if (currentX > 30) {
              billItem.style.transform = 'translateX(-60px)';
              billItem.querySelector('.bill-delete').style.display = 'flex';
            } else {
              billItem.style.transform = 'translateX(0)';
              billItem.querySelector('.bill-delete').style.display = 'none';
            }
            isSliding = false;
          }
        });
        
        // åˆ é™¤æŒ‰é’®äº‹ä»¶ï¼ˆiOSé€‚é…ï¼‰
        const deleteBtn = billItem.querySelector('.bill-delete');
        deleteBtn.addEventListener('click', () => {
          if (confirm('ç¡®å®šåˆ é™¤è¯¥è´¦å•å—ï¼Ÿ')) {
            deleteBill(bill.id);
          } else {
            billItem.style.transform = 'translateX(0)';
            deleteBtn.style.display = 'none';
          }
        });
        deleteBtn.addEventListener('touchstart', (e) => {
          e.preventDefault();
          if (confirm('ç¡®å®šåˆ é™¤è¯¥è´¦å•å—ï¼Ÿ')) {
            deleteBill(bill.id);
          } else {
            billItem.style.transform = 'translateX(0)';
            deleteBtn.style.display = 'none';
          }
        });
        
        billList.appendChild(billItem);
      });
    }

    // åˆ é™¤è´¦å•
    function deleteBill(billId) {
      let bills = JSON.parse(localStorage.getItem('phoneBills'));
      bills = bills.filter(bill => bill.id !== billId);
      localStorage.setItem('phoneBills', JSON.stringify(bills));
      updatePageData();
    }

    // æ ¼å¼åŒ–æ—¥æœŸ
    function formatDate(date) {
      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${date.toLocaleDateString()}`;
    }

    // è·å–æœˆä»½é”®
    function getMonthKey(date) {
      return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
    }
  </script>
</body>
</html>
